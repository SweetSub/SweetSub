# 自动更新章节标题和链接
# 该 Action 会检测所有有改动的目录，寻找其中的 xxx - **.chs.ass， ** 为两位数数字。
# ass 文件中单集标题行需要在说话人处用 ep_title 标注
# 该 ass 文件的同目录下需要有含有 <auto-generated-table> </auto-generated-table> 标记的 README.md 文件
# 该 Action 会自动更改 <auto-generated-table> </auto-generated-table> 中的表格

name: Auto-Generate-Table

on:
  push:
    branches: 
      - "master" 
    paths: 
      - "**.ass"

  workflow_dispatch:


jobs:
  Auto-Generate-Table:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write

    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.head_ref }}

      - name: Get changed files
        id: changed-files
        with:
          separator: ', '
        uses: tj-actions/changed-files@v46
        
      - name: Run py script
        id: py-script
        env:
          ALL_CHANGED_FILES: ${{ steps.changed-files.outputs.all_changed_files }}
        run:
          python .github/workflows/update_readme.py "${ALL_CHANGED_FILES}"

      - name: Commit
        uses: stefanzweifel/git-auto-commit-action@v5

          